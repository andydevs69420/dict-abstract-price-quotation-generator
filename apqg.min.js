(function(){function a(a){if("Object"!==a.constructor.name)throw new TypeError("size must be an Object type!, got "+a.constructor.name);if((null===a._w||void 0===a._w)&&(null===a._h||void 0===a._h))throw new TypeError("invalid size "+a);if("Number"!==a._w.constructor.name&&"Number"!==a._h.constructor.name)throw new TypeError("invalid size "+a);return a}function b(a,b){let e=document.createElement(a);if(!b)return e;if("Object"!==b.constructor.name)throw new TypeError("option must be an Object type!, got "+b.constructor.name);let f=Object.keys(b);return f.forEach(a=>{switch(a){case"style":c(e,b[a]);break;case"attrib":d(e,b[a]);break;default:throw new InvalidPropertyError("invalid property: "+a);}}),e}function c(a,b){if(!(a instanceof HTMLElement))throw new TypeError("element must be an Object type!, got "+a.constructor.name);if("Object"!==b.constructor.name)throw new TypeError("properties must be an Object type!, got "+b.constructor.name);let c=Object.keys(b);return c.forEach(c=>{propname=e(c),propvalue=b[c],a.style[propname]=propvalue}),a}function d(a,b){if(!(a instanceof HTMLElement))throw new TypeError("element must be an Object type!, got "+a.constructor.name);if("Object"!==b.constructor.name)throw new TypeError("properties must be an Object type!, got "+b.constructor.name);let c=Object.keys(b);return c.forEach(c=>{attrib=b[c],a.setAttribute(c,attrib)}),a}function e(a){let b=a.toString().split("-"),c="";for(let d=0;d<b.length;d++)c+=0==d?b[d].toLowerCase():b[d].charAt(0).toUpperCase()+b[d].slice(1);return c}window.PAPER_SIZE=Object.freeze({A4:{_w:210,_h:297},LEGAL:{_w:216,_h:356}}),window.PAPER_ORIENTATION=Object.freeze({PORTRAIT:"p",LANDSCAPE:"l"}),instance_no=-1,window.AbstractPriceQuotationGenerator=class{constructor(b={size:PAPER_SIZE.A4,orientation:PAPER_ORIENTATION.LANDSCAPE}){if("Object"!==b.constructor.name)throw new TypeError("option must be an Object type!, got "+b.constructor.name);instance_no++,this.LOOKUP_TAG="dict-apqg",this.NUMBER_OF_UNITS=9,this.PURPOSE_SLOT_ID="purpose-slot-value",this.PARENT=document.getElementsByTagName(this.LOOKUP_TAG)[instance_no],c(this.PARENT,{display:"flex","align-items":"center","justify-content":"center"}),this.SIZE=a(b.size),this.ORIENTATION=b.orientation,this.PURPOSE=null,this.SUPPLIERS=null,this.HEADERLST=null,this.PAGE_HEAD=[],this.COLSPANS=[],this.ITEM_LIST=[],this.ITEM_ROWS=[]}make__Paper(){let a=b("section");return a=c(a,{display:"flex","align-items":"center","justify-content":"center",margin:"auto",width:this.SIZE._w+"mm",height:this.SIZE._h+"mm","background-color":"#FFFFFF"}),this.ORIENTATION===PAPER_ORIENTATION.LANDSCAPE&&(a=c(a,{width:this.SIZE._h+"mm",height:this.SIZE._w+"mm"})),a}make__Table(a,c,d=!0){if(!a instanceof HTMLElement)throw new TypeError("wrapper must be an HTMLElement type!, got "+a.constructor.name);if("Array"===!c.constructor.name)throw new TypeError("header must be an Array type!, got "+c.constructor.name);if("Boolean"===!d.constructor.name)throw new TypeError("hasPurpose must be an Boolean type!, got "+d.constructor.name);let e=b("table",{style:{width:"90%",margin:"auto",border:"1px solid black","border-collapse":"collapse","table-layout":"fixed"}}),f=b("thead"),g=b("tr",{style:{"border-bottom":"1px solid black"}}),h=b("th",{style:{height:"auto",padding:".5em","vertical-align":"top"},attrib:{colspan:this.NUMBER_OF_UNITS-(this.NUMBER_OF_UNITS-1)}});h.innerText="Purpose:";let i=b("td",{style:{height:"auto",padding:".5em","vertical-align":"middle"},attrib:{colspan:this.NUMBER_OF_UNITS-1}});i.innerText=this.truncate__Text(this.PURPOSE,255),g.appendChild(h),g.appendChild(i),d&&f.appendChild(g);let j=b("thead"),k=b("tr",{style:{"border-bottom":"1px solid black"}});c.sort((c,a)=>{let b=this.HEADERLST.map(a=>a[0]),d=this.HEADERLST.map(a=>a[1]);return b[d.indexOf(c)]>b[d.indexOf(a)]?1:b[d.indexOf(c)]<b[d.indexOf(a)]?-1:0});let l=0;for(let b=0;b<c.length;b++)for(let a=0;a<c.length;a++)c[a].length>c[l].length&&(l=a);let m=0,n=[];return c.forEach(a=>{n.push(m===l?(()=>{let a=this.NUMBER_OF_UNITS-(c.length-1);return 0>=a?"1":a})():(()=>{let a=this.NUMBER_OF_UNITS-this.NUMBER_OF_UNITS-(c.length-1);return 0>=a?"1":a})());let d=b("th",{style:{padding:".8em .2em","text-align":"center","border-left":0===m?"none":"1px solid black","overflow-wrap":"break-word"},attrib:{colspan:n[n.length-1]}});d.innerText=this.truncate__Text(a,40),k.appendChild(d),m++}),this.COLSPANS.push(n),j.appendChild(k),e.appendChild(f),e.appendChild(j),e}append__Rows(a,c){if(!a instanceof HTMLElement)throw new TypeError("table must be an HTMLElement type!, got "+a.constructor.name);if("Number"!==c.constructor.name)throw new TypeError("page_num_in_index must be an Number type!, got "+c.constructor.name);this.ITEM_ROWS[c].forEach(d=>{let e=b("tr",{style:{"border-bottom":"1px solid black"}}),f=0;d.forEach(a=>{let d=b("td",{style:{padding:".8em .2em","text-align":"center","border-left":0===f?"none":"1px solid black","overflow-wrap":"break-word"},attrib:{colspan:this.COLSPANS[c][f]}});d.innerText=this.truncate__Text(a.toString(),40),e.appendChild(d),f++}),a.appendChild(e)})}truncate__Text(a,b=50){if("String"!==a.constructor.name)throw new TypeError("text must be a String type!, got "+a.constructor.name);if("Number"!==b.constructor.name)throw new TypeError("limit must be a Number type!, got "+b.constructor.name);return a.length>b-3?a.substring(0,b-3)+"...":a}setPurpose(a){if("String"!==a.constructor.name)throw new TypeError("string must be an String type!, got "+a.constructor.name);this.PURPOSE=a}markAsSupplier(a){if(!this.PURPOSE)throw new Error("Purpose must be set before marking as supplier!");if("Array"!==a.constructor.name)throw new TypeError("suppliers must be an Array type!, got "+a.constructor.name);this.SUPPLIERS=a}setColumnHeader(a){if(!this.SUPPLIERS)throw new Error("Suppliers must be set before setting column header!");if("Array"!==a.constructor.name)throw new TypeError("header must be an Array type!, got "+a.constructor.name);for(this.SUPPLIERS?.forEach(b=>{if(!a.map(a=>a[1]).includes(b))throw new Error("supplier "+b+" is not found in the given column header!")}),this.HEADERLST=a;this.COL_HEADER?.firstChild;)this.COL_HEADER?.removeChild(this.COL_HEADER.firstChild);let b=this.SUPPLIERS.map(a=>a),c=a.map(a=>a[1]).filter(a=>!b.includes(a));for(;0<b.length;){let a=c.map(a=>a);a=a.concat(b.splice(0,3)),this.PAGE_HEAD.push(a)}}addRow(a){if("Array"!==a.constructor.name)throw new TypeError("row must be an Array type!, got "+a.constructor.name);if(a.length!==this.HEADERLST.length)throw new Error("invalid row column count! expected "+this.HEADERLST.length+", got "+a.length);this.ITEM_LIST.push(a),this.ITEM_ROWS=[],this.PAGE_HEAD.forEach(a=>{let b=this.SUPPLIERS.filter(b=>a.includes(b)).map(a=>this.HEADERLST.map(a=>a[1]).indexOf(a));console.log(b);let c=this.SUPPLIERS.map(a=>a),d=this.HEADERLST.map(a=>a[1]).filter(a=>!c.includes(a)).map(a=>this.HEADERLST.map(a=>a[1]).indexOf(a)),e=d.concat(b).sort((c,a)=>c<a?-1:1),f=[];this.ITEM_LIST.forEach(a=>{let b=[];e.forEach(c=>{b.push(a[c])}),f.push(b)}),this.ITEM_ROWS.push(f)})}generatexxxx(){if(!this.HEADERLST)throw new Error("Column header must be set before generating!");let a=b("div",{style:{width:"fit-content"}});if(this.PARENT?.appendChild(a),1===this.PAGE_HEAD.length){let c=this.make__Paper(),d=b("div"),e=this.make__Table(d,this.PAGE_HEAD[0],!0);c.appendChild(d),a?.appendChild(c)}else{let c=0,d=!0;this.PAGE_HEAD.forEach(e=>{let f=this.make__Paper(),g=b("div"),h=this.make__Table(g,e,d);this.append__Rows(h,c),g.appendChild(h),c++,d=!1,f.appendChild(g),a?.appendChild(f)})}let c=[3.779527559*this.SIZE._w,3.779527559*this.SIZE._h],d=new jspdf.jsPDF({orientation:this.ORIENTATION,format:"l"===this.ORIENTATION?c.reverse():c,unit:"px"});d.html(a,{x:0,y:0,callback:function(){}})}getPaper(){return this.PAPER}},window.TypeError=class extends Error{constructor(a){super(a),this.name="TypeError"}},window.InvalidPropertyError=class extends Error{constructor(a){super(a),this.name="InvalidPropertyError"}}})();