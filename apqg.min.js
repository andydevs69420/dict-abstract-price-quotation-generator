(function(){function a(a){if("Object"!==a.constructor.name)throw new TypeError("size must be an Object type!, got "+a.constructor.name);if((null===a._w||void 0===a._w)&&(null===a._h||void 0===a._h))throw new TypeError("invalid size "+a);if("Number"!==a._w.constructor.name&&"Number"!==a._h.constructor.name)throw new TypeError("invalid size "+a);return a}function b(a,b){let e=document.createElement(a);if(!b)return e;if("Object"!==b.constructor.name)throw new TypeError("option must be an Object type!, got "+b.constructor.name);let f=Object.keys(b);return f.forEach(a=>{switch(a){case"style":c(e,b[a]);break;case"attrib":d(e,b[a]);break;default:throw new InvalidPropertyError("invalid property: "+a);}}),e}function c(a,b){if(!(a instanceof HTMLElement))throw new TypeError("element must be an Object type!, got "+a.constructor.name);if("Object"!==b.constructor.name)throw new TypeError("properties must be an Object type!, got "+b.constructor.name);let c=Object.keys(b);return c.forEach(c=>{propname=e(c),propvalue=b[c],a.style[propname]=propvalue}),a}function d(a,b){if(!(a instanceof HTMLElement))throw new TypeError("element must be an Object type!, got "+a.constructor.name);if("Object"!==b.constructor.name)throw new TypeError("properties must be an Object type!, got "+b.constructor.name);let c=Object.keys(b);return c.forEach(c=>{attrib=b[c],a.setAttribute(c,attrib)}),a}function e(a){let b=a.toString().split("-"),c="";for(let d=0;d<b.length;d++)c+=0==d?b[d].toLowerCase():b[d].charAt(0).toUpperCase()+b[d].slice(1);return c}window.PAPER_SIZE=Object.freeze({A4:{_w:210,_h:297},LEGAL:{_w:216,_h:356}}),window.PAPER_ORIENTATION=Object.freeze({PORTRAIT:"p",LANDSCAPE:"l"}),instance_no=-1,window.AbstractPriceQuotationGenerator=class{constructor(b={size:PAPER_SIZE.A4,orientation:PAPER_ORIENTATION.LANDSCAPE}){if("Object"!==b.constructor.name)throw new TypeError("option must be an Object type!, got "+b.constructor.name);instance_no++,this.LOOKUP_TAG="dict-apqg",this.NUMBER_OF_UNITS=9,this.PURPOSE_SLOT_ID="purpose-slot-value",this.PARENT=document.getElementsByTagName(this.LOOKUP_TAG)[instance_no],this.SIZE=a(b.size),this.ORIENTATION=b.orientation,this.SUPPLIERS=null,this.PURPOSE=null,this.PAGE_HEAD=[]}make__Paper(){let a=b("section");return a=c(a,{display:"flex","align-items":"center","justify-content":"center",margin:"auto",width:this.SIZE._w+"mm",height:this.SIZE._h+"mm","background-color":"#FFFFFF"}),this.ORIENTATION===PAPER_ORIENTATION.LANDSCAPE&&(a=c(a,{width:this.SIZE._h+"mm",height:this.SIZE._w+"mm"})),a}make__Table(a,c=!0){if("Array"===!a.constructor.name)throw new TypeError("header must be an Array type!, got "+a.constructor.name);if("Boolean"===!c.constructor.name)throw new TypeError("hasPurpose must be an Boolean type!, got "+c.constructor.name);let d=b("table",{style:{width:"90%",margin:"auto",border:"1px solid black","border-collapse":"collapse","table-layout":"fixed"}}),e=b("thead"),f=b("tr",{style:{"border-bottom":"1px solid black"}}),g=b("th",{style:{height:"auto",padding:".5em","vertical-align":"top"},attrib:{colspan:this.NUMBER_OF_UNITS-(this.NUMBER_OF_UNITS-1)}});g.innerText="Purpose:";let h=b("td",{style:{height:"auto",padding:".5em","vertical-align":"middle"},attrib:{colspan:this.NUMBER_OF_UNITS-1}});h.innerText=this.PURPOSE,f.appendChild(g),f.appendChild(h),c&&e.appendChild(f);let i=b("thead"),j=b("tr",{style:{"border-bottom":"1px solid black"}}),k=0;for(let b=0;b<a.length;b++)for(let b=0;b<a.length;b++)a[b].length>a[k].length&&(k=b);let l=0;return a.forEach(c=>{let d=b("th",{style:{padding:".8em .2em","text-align":"center","border-left":0===l?"none":"1px solid black","overflow-wrap":"break-word"},attrib:{colspan:l===k?(()=>{let b=this.NUMBER_OF_UNITS-(a.length-1);return 0>=b?"1":b})():(()=>{let b=this.NUMBER_OF_UNITS-this.NUMBER_OF_UNITS-(a.length-1);return 0>=b?"1":b})()}});d.innerText=c,j.appendChild(d),l++}),i.appendChild(j),d.appendChild(e),d.appendChild(i),d}setPurpose(a){if("String"!==a.constructor.name)throw new TypeError("string must be an String type!, got "+a.constructor.name);this.PURPOSE=a}markAsSupplier(a){if("Array"!==a.constructor.name)throw new TypeError("suppliers must be an Array type!, got "+a.constructor.name);this.SUPPLIERS=a}setColumnHeader(a){if(!this.SUPPLIERS)throw new Error("Suppliers not set!");if("Array"!==a.constructor.name)throw new TypeError("header must be an Array type!, got "+a.constructor.name);this.SUPPLIERS?.forEach(b=>{if(!a.map(a=>a[1]).includes(b))throw new Error("supplier "+b+" is not found in the given column header!")});for(;this.COL_HEADER?.firstChild;)this.COL_HEADER?.removeChild(this.COL_HEADER.firstChild);if(this.NUMBER_OF_UNITS<a.length)for(;0<this.SUPPLIERS.length;)this.PAGE_HEAD.push(this.SUPPLIERS.splice(0,3));console.log(a)}generatexxxx(){let a=!0;this.PAGE_HEAD.forEach(b=>{let c=this.make__Paper(),d=this.make__Table(b,a);c.appendChild(d),a=!1,this.PARENT?.append(c)});let b=[this.PAPER.offsetWidth,this.PAPER.offsetHeight],c=new jspdf.jsPDF({orientation:this.ORIENTATION,format:"l"===this.ORIENTATION?b.reverse():b,unit:"px"});c.html(this.PAPER,{callback:function(a){a.output("dataurlnewwindow")}})}getPaper(){return this.PAPER}},window.TypeError=class extends Error{constructor(a){super(a),this.name="TypeError"}},window.InvalidPropertyError=class extends Error{constructor(a){super(a),this.name="InvalidPropertyError"}}})();